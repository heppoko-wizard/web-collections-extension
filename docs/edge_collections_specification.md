# Microsoft Edge Collections 機能仕様書

> [!CAUTION]
> **2026年1月現在、Microsoft Edge Collections機能は廃止プロセス中です。**  
> 新規アイテムの追加が不可になり、ユーザーはデータのエクスポートまたはお気に入りへの移行を推奨されています。

---

## 1. 概要

**Collections（コレクション）** は、Microsoft Edgeに搭載されていたWebコンテンツ収集・整理機能です。リサーチ、ショッピング、旅行計画などの用途で、Webから情報を効率的に収集し、整理・管理するためのデジタルワークスペースとして設計されていました。

### 1.1 お気に入り（Favorites）との違い

| 特徴 | Collections | Favorites |
|------|-------------|-----------|
| **用途** | プロジェクト単位の一時的なコンテンツ収集 | 頻繁に訪れるサイトの長期保存 |
| **表示形式** | 大きなサムネイル付きのビジュアル表示 | テキストベースのリスト表示 |
| **保存可能なもの** | Webページ、テキスト、画像、メモ | URLのみ |
| **完了後** | 削除想定 | 継続利用想定 |

---

## 2. コアデータモデル

### 2.1 Collection（コレクション本体）

```
Collection {
  id: UUID
  name: string              // ユーザー定義のコレクション名
  createdAt: timestamp
  updatedAt: timestamp
  items: CollectionItem[]   // 収集したアイテムの配列
  syncEnabled: boolean      // クラウド同期の有効/無効
}
```

### 2.2 CollectionItem（収集アイテム）

コレクション内に保存できるアイテムは以下の4種類：

#### 2.2.1 Webページアイテム

```
WebPageItem {
  type: "webpage"
  id: UUID
  url: string               // ページのURL
  title: string             // ページタイトル
  domain: string            // ドメイン名
  thumbnailUrl: string      // プレビュー画像のURL
  faviconUrl: string        // ファビコンURL
  savedAt: timestamp
  sortOrder: number         // 表示順序
}
```

#### 2.2.2 テキスト抜粋アイテム

```
TextSnippetItem {
  type: "text"
  id: UUID
  content: string           // 抜粋したテキスト内容
  sourceUrl: string         // 元のページURL
  sourceTitle: string       // 元のページタイトル
  savedAt: timestamp
  sortOrder: number
}
```

#### 2.2.3 画像アイテム

```
ImageItem {
  type: "image"
  id: UUID
  imageUrl: string          // 画像のURL
  sourceUrl: string         // 画像が掲載されていたページのURL
  altText: string           // 代替テキスト（あれば）
  savedAt: timestamp
  sortOrder: number
}
```

#### 2.2.4 メモアイテム

```
NoteItem {
  type: "note"
  id: UUID
  content: string           // ユーザーが入力したメモ内容
  createdAt: timestamp
  updatedAt: timestamp
  sortOrder: number
}
```

---

## 3. ユーザーインターフェース仕様

### 3.1 アクセス方法

| 操作 | 方法 |
|------|------|
| **キーボードショートカット** | `Ctrl + Shift + Y` |
| **ツールバー** | アドレスバー横のCollectionsアイコンをクリック |
| **メニュー** | 設定メニュー → Collections |

### 3.2 パネル表示

- **サイドパネル表示**: ブラウザウィンドウの右側にオーバーレイまたはピン留め表示
- **ピン留め機能**: パネルを常時表示に固定可能
- **幅調整**: パネル幅のリサイズ対応

### 3.3 コレクション一覧画面

```
┌─────────────────────────────────┐
│  Collections                [×] │
├─────────────────────────────────┤
│  [+] 新しいコレクションを開始    │
├─────────────────────────────────┤
│  ┌─────────┐                    │
│  │ 🖼️      │  旅行計画 2024     │
│  │ thumb   │  5 items           │
│  └─────────┘                    │
│  ┌─────────┐                    │
│  │ 🖼️      │  買い物リスト       │
│  │ thumb   │  12 items          │
│  └─────────┘                    │
│  ┌─────────┐                    │
│  │ 🖼️      │  リサーチ資料       │
│  │ thumb   │  8 items           │
│  └─────────┘                    │
└─────────────────────────────────┘
```

### 3.4 コレクション詳細画面

```
┌─────────────────────────────────┐
│ ← 旅行計画 2024        [⋯] [×] │
├─────────────────────────────────┤
│ [+ 現在のページを追加]          │
│ [📝 メモを追加]                 │
├─────────────────────────────────┤
│ ┌───────────────────────────┐   │
│ │ 🌐 example.com            │   │
│ │ ┌─────┐ ホテル予約サイト   │   │
│ │ │thumb│ 素敵なホテルを発見 │   │
│ │ └─────┘                   │   │
│ └───────────────────────────┘   │
│ ┌───────────────────────────┐   │
│ │ 📝 メモ                   │   │
│ │ 3泊4日の予定で予約する     │   │
│ └───────────────────────────┘   │
│ ┌───────────────────────────┐   │
│ │ 🖼️ 画像                   │   │
│ │ [風景写真サムネイル]       │   │
│ └───────────────────────────┘   │
│ ┌───────────────────────────┐   │
│ │ " テキスト抜粋             │   │
│ │ 「チェックインは15時から」  │   │
│ │ 出典: example.com          │   │
│ └───────────────────────────┘   │
└─────────────────────────────────┘
```

---

## 4. 操作機能仕様

### 4.1 アイテム追加方法

| 対象 | 追加方法 |
|------|----------|
| **現在のページ** | パネル内「現在のページを追加」ボタン |
| **任意のページ** | ページ上で右クリック → 「コレクションに追加」 |
| **テキスト** | テキストを選択 → 右クリック → 「コレクションに追加」 |
| **画像** | 画像を右クリック → 「コレクションに追加」 |
| **画像（D&D）** | 画像をCollectionsパネルにドラッグ＆ドロップ |
| **メモ** | パネル内「メモを追加」ボタン → テキスト入力 → 保存 |

### 4.2 アイテム操作

| 操作 | 説明 |
|------|------|
| **開く** | アイテムをクリック → 元のページに遷移 |
| **並び替え** | ドラッグ＆ドロップで順序変更 |
| **削除** | アイテムの「×」ボタンまたは右クリックメニュー |
| **一括オープン** | コレクションの全リンクを新しいウィンドウ/タブで開く |

### 4.3 コレクション操作

| 操作 | 説明 |
|------|------|
| **作成** | 「新しいコレクションを開始」をクリック |
| **名前変更** | コレクション名をクリックして編集 |
| **削除** | コレクションの「⋯」メニュー → 削除 |
| **ピン留め** | パネルをブラウザに固定表示 |

---

## 5. エクスポート機能仕様

### 5.1 対応エクスポート形式

| 形式 | 用途 | 保持される内容 |
|------|------|----------------|
| **Excel (.xlsx)** | データ分析 | URL、タイトル、メモをテーブル形式で |
| **Word (.docx)** | 文書作成・引用 | テキスト、画像、リンクを文書形式で |
| **OneNote** | クラウドノート連携 | 全コンテンツをノート形式で |
| **CSV** | 汎用データ保存 | 全アイテムをカンマ区切りで |
| **クリップボード** | コピー＆ペースト | リッチフォーマット対応アプリにペースト可能 |

### 5.2 CSVエクスポート形式（推測）

```csv
collection_name,item_type,title,url,content,source_url,saved_at
"旅行計画","webpage","ホテル予約","https://example.com/hotel","","","2024-01-15T10:30:00Z"
"旅行計画","note","","","3泊4日で予約","","2024-01-15T11:00:00Z"
"旅行計画","text","","","チェックイン15時","https://example.com/hotel","2024-01-15T10:35:00Z"
"旅行計画","image","","https://example.com/img.jpg","","https://example.com/hotel","2024-01-15T10:32:00Z"
```

### 5.3 エクスポート操作手順

1. コレクションを開く
2. 「⋯」（その他のオプション）メニューをクリック
3. 「送信先」サブメニューから形式を選択
   - 「Excel に送信」
   - 「Word に送信」
   - 「OneNote に送信」

---

## 6. 同期機能仕様

### 6.1 同期メカニズム

- **認証**: Microsoft アカウントでサインイン必須
- **同期対象**: 全コレクションと全アイテム
- **同期タイミング**: 自動（変更検出時）
- **ストレージ**: Microsoft クラウドサーバー
- **ローカルストレージ**: SQLite データベース形式

### 6.2 同期設定

```
edge://settings/profiles/sync
```

- コレクションの同期を個別にオン/オフ可能
- プライバシー設定でエンタープライズ制御可能

### 6.3 ローカルデータ保存場所（参考）

```
%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Collections\
```

- SQLite形式のデータベースファイルとして保存
- サムネイル画像はキャッシュとして別途保存

---

## 7. キーボードアクセシビリティ

### 7.1 キーボードショートカット

| ショートカット | 動作 |
|----------------|------|
| `Ctrl + Shift + Y` | Collectionsパネルの開閉 |

### 7.2 パネル内キーボード操作（スクリーンリーダー対応）

| 操作 | キー |
|------|------|
| コレクション選択 | `Tab` / `Shift + Tab` |
| 決定 | `Enter` |
| 「現在のページを追加」へ移動 | `Shift + Tab` 数回 |
| 「メモを追加」へ移動 | `Shift + Tab` 数回 |
| メモ保存 | テキスト入力後 `Shift + Tab` → 「Save」で `Enter` |

---

## 8. 右クリックコンテキストメニュー

### 8.1 ページ上での右クリック

```
┌─────────────────────────┐
│  ...                    │
│  コレクションに追加 → │ ─┐
│  ...                    │  │
└─────────────────────────┘  │
                             ↓
                    ┌─────────────────┐
                    │ 旅行計画 2024   │
                    │ 買い物リスト     │
                    │ リサーチ資料     │
                    ├─────────────────┤
                    │ + 新しいコレク... │
                    └─────────────────┘
```

### 8.2 選択テキスト上での右クリック

- 「コレクションに追加」オプションが表示
- テキスト内容と元URLがセットで保存される

### 8.3 画像上での右クリック

- 「コレクションに追加」オプションが表示
- 画像URLと元ページURLがセットで保存される

---

## 9. エンタープライズポリシー

### 9.1 グループポリシー設定

| ポリシー名 | 説明 |
|------------|------|
| `EdgeCollectionsEnabled` | Collections機能の有効/無効を制御 |

```
Computer Configuration > Administrative Templates > Microsoft Edge > Collections
  → Enable Collections: Enabled / Disabled
```

---

## 10. 拡張機能で再現する場合の要件サマリー

### 10.1 必須機能（Must Have）

- [ ] **コレクション管理**: 複数コレクションの作成・命名・削除
- [ ] **Webページ保存**: URL、タイトル、サムネイル、ファビコンの取得と保存
- [ ] **テキスト抜粋保存**: 選択テキスト + 元URL の保存
- [ ] **画像保存**: 画像URL + 元URL の保存
- [ ] **メモ機能**: 自由テキストのメモ作成・編集
- [ ] **ドラッグ＆ドロップ並び替え**: アイテム順序の変更
- [ ] **コンテキストメニュー統合**: 右クリックからの追加
- [ ] **サイドパネルUI**: ブラウザ横に表示されるパネル
- [ ] **一括タブオープン**: コレクション内の全リンクを一度に開く

### 10.2 推奨機能（Should Have）

- [ ] **エクスポート**: CSV、JSON形式での出力
- [ ] **インポート**: Edge Collectionsからのデータ移行
- [ ] **クラウド同期**: 独自バックエンドまたは外部サービス連携
- [ ] **キーボードショートカット**: `Ctrl + Shift + Y` 等の設定
- [ ] **ダークモード対応**: システム設定に追従

### 10.3 オプション機能（Nice to Have）

- [ ] **Office連携**: Excel/Word/OneNoteへの直接エクスポート
- [ ] **タグ/ラベル**: アイテムの分類機能
- [ ] **検索機能**: コレクション内のコンテンツ検索
- [ ] **共有機能**: コレクションの他ユーザーとの共有

---

## 11. 参考：既存の類似拡張機能

調査の際に比較対象となり得る既存の拡張機能：

- **Pocket** - 後で読むサービス
- **Raindrop.io** - ブックマーク管理
- **Notion Web Clipper** - Notionとの連携クリッパー
- **Evernote Web Clipper** - Evernoteとの連携クリッパー

---

*最終更新: 2026年1月16日*
*調査ソース: Microsoft公式ドキュメント、テックニュースサイト、ユーザーコミュニティ*
